 void func_0 ( ) char * variable_0 ; CWE127_Buffer_Underread__char_declare_memmove_67_structType variable_1 ; char variable_2 [ 100 ] ; memset ( variable_2 , ' A ' , 100 - 1 ) ; variable_2 [ 100 - 1 ] = ' \0 ' ; variable_0 = variable_2 - 8 ; variable_1 . variable_3 = variable_0 ; func_1 ( variable_1 ) ; void func_2 ( CWE127_Buffer_Underread__char_declare_memmove_67_structType variable_1 ) char * variable_0 = variable_1 . variable_3 ; char variable_4 [ 100 ] ; memset ( variable_4 , ' C ' , 100 - 1 ) ; variable_4 [ 100 - 1 ] = ' \0 ' ; memmove ( variable_4 , variable_0 , 100 * sizeof ( char ) ) ; variable_4 [ 100 - 1 ] = ' \0 ' ; func_3 ( variable_4 ) ; void func_4 ( const char * variable_5 ) if ( variable_5 != NULL ) printf ( " %s \n " , variable_5 ) ;
 int main ( int variable_0 , char * variable_1 [ ] ) char * variable_2 ; variable_2 = getenv ( " CONTENT_TYPE " ) ; if ( variable_2 ) variable_3 [ 0 ] = ' \0 ' ; if ( func_0 ( variable_4 , " post " ) ) if ( func_1 ( variable_3 , " application / x - www - form - urlencoded " ) ) if ( func_2 ( variable_3 , " multipart / form - data " ) ) static int func_3 ( char * variable_5 , char * variable_6 ) while ( 1 ) if ( ! ( * variable_5 ) ) if ( ! ( * variable_6 ) ) return 1 ; return 0 ; if ( ! ( * variable_6 ) ) return 0 ; if ( isalpha ( * variable_5 ) ) if ( tolower ( * variable_5 ) != tolower ( * variable_6 ) ) return 0 ; if ( ( * variable_5 ) != ( * variable_6 ) ) return 0 ; variable_5 ++ ; variable_6 ++ ; if ( func_4 ( ) != variable_7 ) static cgiParseResultType func_5 ( ) cgiParseResultType variable_8 ; int variable_9 ; char variable_10 [ 1024 ] ; mpStreamPtr variable_11 = & variable_12 ; if ( ! variable_13 ) return variable_7 ; variable_8 = func_6 ( variable_11 , 0 , 0 , 0 , 1 ) ; cgiParseResultType func_7 ( mpStreamPtr variable_11 , FILE * variable_14 , char int * variable_15 , int variable_16 ) int variable_17 = 256 ; cgiParseResultType variable_8 ; int variable_18 ; int variable_9 ; char variable_19 [ 2 ] ; char variable_20 [ 1024 ] ; char * variable_21 = variable_20 ; int variable_22 ; if ( ( ! variable_14 ) && ( variable_23 ) ) variable_24 = ( char * ) malloc ( variable_17 ) ; if ( ! variable_24 ) variable_18 = 0 ; sprintf ( variable_20 , " \r \n -- %s " , variable_25 ) ; if ( variable_16 ) variable_21 = variable_20 + 2 ; variable_22 = strlen ( variable_21 ) ; while ( 1 ) variable_9 = func_8 ( variable_11 , variable_19 , 1 ) ; int func_9 ( mpStreamPtr variable_11 , char * variable_26 , int variable_27 ) int variable_28 = variable_27 ; int variable_9 = 0 ; if ( variable_27 > ( variable_13 - variable_11 -> variable_29 ) ) variable_27 = variable_13 - variable_11 -> variable_29 ; while ( variable_27 ) if ( variable_11 -> variable_30 != variable_11 -> variable_31 ) * variable_26 ++ = variable_11 -> variable_32 [ variable_11 -> variable_30 ++ ] ; variable_11 -> variable_30 %= sizeof ( variable_11 -> variable_32 ) ; variable_9 ++ ; variable_27 -- ; if ( variable_27 ) int variable_33 = fread ( variable_26 , 1 , variable_27 , variable_34 ) ; if ( variable_33 >= 0 ) return variable_9 + variable_33 ; if ( variable_9 > 0 ) return variable_9 ; return variable_33 ; if ( variable_9 ) return variable_9 ; if ( variable_28 ) return variable_35 ; return 0 ; if ( variable_9 != 1 ) variable_8 = variable_36 ; if ( variable_19 [ 0 ] == variable_21 [ variable_18 ] ) variable_18 ++ ; if ( variable_18 == variable_22 ) if ( variable_18 > 0 ) variable_18 = 0 ; variable_9 = func_10 ( variable_11 , variable_19 , 2 ) ; int func_11 ( mpStreamPtr variable_11 , char * variable_26 , int variable_27 ) int variable_28 = variable_27 ; int variable_9 = 0 ; if ( variable_27 > ( variable_13 - variable_11 -> variable_29 ) ) variable_27 = variable_13 - variable_11 -> variable_29 ; while ( variable_27 ) if ( variable_11 -> variable_30 != variable_11 -> variable_31 ) * variable_26 ++ = variable_11 -> variable_32 [ variable_11 -> variable_30 ++ ] ; variable_11 -> variable_30 %= sizeof ( variable_11 -> variable_32 ) ; variable_9 ++ ; variable_27 -- ; if ( variable_27 ) int variable_33 = fread ( variable_26 , 1 , variable_27 , variable_34 ) ; if ( variable_33 >= 0 ) return variable_9 + variable_33 ; if ( variable_9 > 0 ) return variable_9 ; return variable_33 ; if ( variable_9 ) return variable_9 ; if ( variable_28 ) return variable_35 ; return 0 ; if ( variable_9 != 2 ) variable_8 = variable_36 ; return variable_7 ; variable_8 = variable_37 ; return variable_8 ; if ( variable_8 == variable_36 ) return variable_7 ; if ( variable_8 != variable_7 ) return variable_8 ; while ( 1 ) char variable_19 [ 1024 ] ; char variable_38 [ 1024 ] ; char variable_39 [ 1024 ] ; int variable_40 = 0 ; char variable_41 [ 1024 ] ; char variable_42 [ 1024 ] ; variable_38 [ 0 ] = 0 ; variable_39 [ 0 ] = 0 ; variable_41 [ 0 ] = 0 ; variable_42 [ 0 ] = 0 ; variable_24 = 0 ; variable_14 = 0 ; variable_9 = func_12 ( variable_11 , variable_19 , 2 ) ; int func_13 ( mpStreamPtr variable_11 , char * variable_26 , int variable_27 ) int variable_28 = variable_27 ; int variable_9 = 0 ; if ( variable_27 > ( variable_13 - variable_11 -> variable_29 ) ) variable_27 = variable_13 - variable_11 -> variable_29 ; while ( variable_27 ) if ( variable_11 -> variable_30 != variable_11 -> variable_31 ) * variable_26 ++ = variable_11 -> variable_32 [ variable_11 -> variable_30 ++ ] ; variable_11 -> variable_30 %= sizeof ( variable_11 -> variable_32 ) ; variable_9 ++ ; variable_27 -- ; if ( variable_27 ) int variable_33 = fread ( variable_26 , 1 , variable_27 , variable_34 ) ; if ( variable_33 >= 0 ) return variable_9 + variable_33 ; if ( variable_9 > 0 ) return variable_9 ; return variable_33 ; if ( variable_9 ) return variable_9 ; if ( variable_28 ) return variable_35 ; return 0 ; if ( variable_9 < 2 ) if ( ( variable_19 [ 0 ] == ' - ' ) && ( variable_19 [ 1 ] == ' - ' ) ) if ( ! func_14 ( variable_38 , " form - data " ) ) static int func_15 ( char * variable_5 , char * variable_6 ) while ( 1 ) if ( ! ( * variable_5 ) ) if ( ! ( * variable_6 ) ) return 1 ; return 0 ; if ( ! ( * variable_6 ) ) return 0 ; if ( isalpha ( * variable_5 ) ) if ( tolower ( * variable_5 ) != tolower ( * variable_6 ) ) return 0 ; if ( ( * variable_5 ) != ( * variable_6 ) ) return 0 ; variable_5 ++ ; variable_6 ++ ; variable_8 = func_16 ( variable_11 , 0 , 0 , 0 , 0 ) ; cgiParseResultType func_17 ( mpStreamPtr variable_11 , FILE * variable_14 , char int * variable_15 , int variable_16 ) int variable_17 = 256 ; cgiParseResultType variable_8 ; int variable_18 ; int variable_9 ; char variable_19 [ 2 ] ; char variable_20 [ 1024 ] ; char * variable_21 = variable_20 ; int variable_22 ; if ( ( ! variable_14 ) && ( variable_23 ) ) variable_24 = ( char * ) malloc ( variable_17 ) ; if ( ! variable_24 ) variable_18 = 0 ; sprintf ( variable_20 , " \r \n -- %s " , variable_25 ) ; if ( variable_16 ) variable_21 = variable_20 + 2 ; variable_22 = strlen ( variable_21 ) ; while ( 1 ) variable_9 = func_18 ( variable_11 , variable_19 , 1 ) ; if ( variable_9 != 1 ) variable_8 = variable_36 ; if ( variable_19 [ 0 ] == variable_21 [ variable_18 ] ) variable_18 ++ ; if ( variable_18 == variable_22 ) if ( variable_18 > 0 ) variable_18 = 0 ; variable_9 = func_19 ( variable_11 , variable_19 , 2 ) ; if ( variable_9 != 2 ) variable_8 = variable_36 ; return variable_7 ; variable_8 = variable_37 ; return variable_8 ; if ( variable_8 != variable_7 ) return variable_8 ; if ( strlen ( variable_41 ) ) if ( func_20 ( variable_10 ) != variable_7 ) static cgiParseResultType func_21 ( char * variable_10 ) int variable_43 ; strcpy ( variable_10 , variable_44 " / cgicXXXXXX " ) variable_43 = func_22 ( variable_10 ) ; if ( variable_43 == - 1 ) return variable_36 ; if ( func_23 ( variable_10 , 0600 ) != 0 ) return variable_36 ; return variable_7 ; return variable_36 ; variable_14 = fopen ( variable_10 , " w + b " ) ; variable_14 = 0 ; variable_8 = func_24 ( variable_11 , variable_14 , & variable_24 , & variable_40 , 0 ) ; cgiParseResultType func_25 ( mpStreamPtr variable_11 , FILE * variable_14 , char int * variable_15 , int variable_16 ) int variable_17 = 256 ; cgiParseResultType variable_8 ; int variable_18 ; int variable_9 ; char variable_19 [ 2 ] ; char variable_20 [ 1024 ] ; char * variable_21 = variable_20 ; int variable_22 ; if ( ( ! variable_14 ) && ( variable_23 ) ) variable_24 = ( char * ) malloc ( variable_17 ) ; if ( ! variable_24 ) variable_18 = 0 ; sprintf ( variable_20 , " \r \n -- %s " , variable_25 ) ; if ( variable_16 ) variable_21 = variable_20 + 2 ; variable_22 = strlen ( variable_21 ) ; while ( 1 ) variable_9 = func_26 ( variable_11 , variable_19 , 1 ) ; if ( variable_9 != 1 ) variable_8 = variable_36 ; if ( variable_19 [ 0 ] == variable_21 [ variable_18 ] ) variable_18 ++ ; if ( variable_18 == variable_22 ) if ( variable_18 > 0 ) variable_18 = 0 ; variable_9 = func_27 ( variable_11 , variable_19 , 2 ) ; if ( variable_9 != 2 ) variable_8 = variable_36 ; return variable_7 ; variable_8 = variable_37 ; return variable_8 ; if ( variable_8 != variable_7 ) return variable_8 ; variable_45 = ( cgiFormEntry * ) malloc ( sizeof ( variable_46 ) ) ; if ( ! variable_45 ) memset ( variable_45 , 0 , sizeof ( variable_46 ) ) ; variable_45 -> variable_47 = ( char * ) malloc ( strlen ( variable_39 ) + 1 ) ; if ( ! variable_45 -> variable_47 ) if ( variable_24 ) if ( variable_14 ) variable_45 -> variable_48 = ( char * ) malloc ( 1 ) ; if ( ! variable_45 -> variable_48 ) variable_45 -> variable_48 [ 0 ] = ' \0 ' ; variable_45 -> variable_49 = variable_40 ; variable_45 -> variable_50 = 0 ; variable_45 -> variable_51 = ( char * ) malloc ( strlen ( variable_41 ) + 1 ) ; if ( ! variable_45 -> variable_51 ) strcpy ( variable_45 -> variable_51 , variable_41 ) ; variable_45 -> variable_52 = ( char * ) malloc ( strlen ( variable_42 ) + 1 ) ; if ( ! variable_45 -> variable_52 ) strcpy ( variable_45 -> variable_52 , variable_42 ) ; variable_45 -> variable_10 = ( char * ) malloc ( strlen ( variable_10 ) + 1 ) ; if ( ! variable_45 -> variable_10 ) return variable_7 ; return variable_37 ; func_28 ( 500 , " Error reading form data " ) ; void func_29 ( int variable_53 , char * variable_54 ) fprintf ( variable_55 , " Status : %d %s \r \n \r \n " , variable_53 , variable_54 ) ;
